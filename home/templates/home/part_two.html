{% extends "base.html" %}
{% load static %}

{% block extra_css %}  
    <link rel="stylesheet" href="{% static 'home/css/home.css' %}">          
{% endblock %}

{% block content %}
    <div class="hero">
        <div class="title text-light text-two h1">Finding Node Network Routes: Part Two</div>
        <div class="overlay"></div>
    </div>
    <header class="bg-header h1 p-2 m-0 text-one">
        <a class="text-decoration-none text-light logo" href="{% url 'home' %}">SimpleAlgo <i class="fas fa-code-branch"></i></a>
    </header>    
    
    <div class="text-secondary fst-italic p-2">By Zahur Meerun July 2022</div>
    <section class="p-1 mt-0 text-two">
        <div class="col-12 h2 text-primary text-center">Content</div>
        <div class="article ps-5 pe-5 w-75 mx-auto"><a class="text-decoration-none" href="{% url 'home' %}">Part 1</a>: Laying down the basics</br>
            <a class="text-decoration-none"  href="{% url 'part_two' %}">Part 2</a>:  Applying our algorithm to a Practical Problem</br>
        </div></br>
        <div class="col-12 h2 text-primary text-center"> Part Two: Practical Example</div>
        <div class="article ps-5 pe-5 w-75 mx-auto">In part 1 of this tutorial We started with a network of nodes represented by a graph and returned all 5 possible routes without revisiting a node. We further extended our
            functionality by returning the minimum path between 2 nodes.
            Now we will expand on this topic and apply what we have learned to a real-life problem</br></br>
        </div>
        <div class="col-12 h2 text-primary text-center">The London Underground <i class="fas fa-subway"></i></div>
        <div class="article ps-5 pe-5 w-75 mx-auto">The London Underground would be a perfect example to test our search algorithm by obtaining all paths between 2 points,
            i.e our departure and arrival.</br></br>
            The Tube is made up of 11 lines, but to simplify things we will only be interested in 5:
            <ul>
                <li class="text-danger fw-bold">Central Line</li>
                <li class="text-dark fw-bold">Northern Line</li>
                <li class="text-warning fw-bold">Circle Line</li>
                <li class="text-info fw-bold">Victoria Line</li>
                <li class="text-brown fw-bold">Bakerloo Line</li>
            </ul>
            Below is the London Underground Map so you can familiarise yourself with the layout. As you can see, the 5 tube lines cover a vast majority
            of the network.
        </br></br>
            <div class="text-center mb-5"><embed src="https://content.tfl.gov.uk/standard-tube-map.pdf" width="90%" height="500px" type="application/pdf"></div>
        </div>
        <div class="col-12 h2 text-primary text-center"> Our Graph</div>
        <div class="article ps-5 pe-5 w-75 mx-auto mb-5">
            Since we can consider each station as a node with edges connecting to other stations, we have a node network similar to what we used in <a class="text-decoration-none" href="{% url 'home' %}">Part 1</a>.</br></br>
            <div class="text-center tree"><img src="{{ MEDIA_URL }}tube.png" alt="data tree structure" /></div>
            The only difference being that each node (station) is linked to 1 or more Underground lines. To cater for this requirement we can adjust our graph so as each node will contain a key-value pair
            consisting of a station (key) and another dictionary (value) made up tube line names and connections.
            <div class="d-flex justify-content-center mt-3 mb-3">
                <div class="ps-2 code-text text-dark fw-bold">
                    graph = {"Station name": {"Tube name": [list of tubes arriving at this station],</br>&emsp;&emsp;&emsp;&emsp;&emsp;"Connections": [list of all connecting stations]}}
                </div>           
            </div>
            I have put togther the required graph using our 5 chosen line and linked it<a class="text-decoration-none" href="https://github.com/zahur76/algo-blog/blob/master/docs/underground.py" target="_blank"> here.</a>
        </div>
        <div class="col-12 h2 text-primary text-center"> Code Recap</div>
        <div class="article ps-5 pe-5 w-75 mx-auto mb-5">
            We will be using our code derived in part 1. The final code returned the shortest path available from 2 nodes. We will
            modify this code to return the 5 shortest paths since this will be more interesting in our case.</br></br>
            The steps will be the same as previously described only with only a few minor modifictions to our code. If you wish to have a recap of the code functionality please go back to <a class="text-decoration-none" href="{% url 'home' %}">Part 1</a>.</br></br>
            Since we have modified our graph to accomodate all tubes lines arriving at our station we will have to update our recursive code to cater for this.

            <div class="d-flex justify-content-center mb-3">
                <div class="ps-2 code-text text-light bg-dark p-2 fw-bold mt-3 border border-5 border-primary">
                    def find_path(graph, vertex, visited):</br>
                    &emsp;&emsp;queue= []</br></br>
                    &emsp;&emsp;<span class="text-primary">print(f'Check connections: {visited , vertex}')</span></br></br>
                    &emsp;&emsp;for node in graph[vertex]<span class="text-warning">['Connections']</span>:</br>
                    &emsp;&emsp;&emsp;&emsp;if node not in visited:</br>
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;queue.append(visited + [node])</br>
                    &emsp;&emsp;if stack:</br></br>
                    &emsp;&emsp;&emsp;&emsp;<span class="text-primary">print(f'queue: {queue}')</span></br></br>
                    &emsp;&emsp;&emsp;&emsp;for route in queue:</br>
                    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;find_connections(graph, route[-1], route)</br>
                    &emsp;&emsp;else:</br></br>
                    &emsp;&emsp;&emsp;&emsp;<span class="text-primary">print(f'No Connections!, queue:{queue}'))</span></br>
                    &emsp;&emsp;&emsp;&emsp;<span class="text-primary">print(f'Add to all routes: {visited}')</span></br></br>
                    &emsp;&emsp;&emsp;&emsp;all_routes.append(visited)</br>
                    &emsp;&emsp;return all_routes
                </div>
            </div>
                Secondly we need to modify our initial code to so as to return only the first 5 paths with shortest lengths.</br>
                <div class="d-flex justify-content-center">
                    <div class="ps-2 code-text text-light bg-dark p-2 fw-bold mt-3 border border-5 border-primary">
                        def find_routes(graph, vertex, end_node, visited=[]):</br>
                        &emsp;&emsp;visited.append(vertex)</br>
                        &emsp;&emsp;paths = find_connections(graph, vertex, visited)</br>
                        &emsp;&emsp;all_paths = []</br>
                        &emsp;&emsp;for route in all_paths:</br>
                        &emsp;&emsp;&emsp;&emsp;if end_node in route:</br>
                        &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;my_paths.append(route[:route.index(end_node)+1])</br>
                        &emsp;&emsp;path_length = []</br>
                        &emsp;&emsp;for path in my_paths:</br>
                        &emsp;&emsp;&emsp;&emsp;path_length.append(len(path))</br>
                        &emsp;&emsp;index_of_minimum = path_length.index(min(path_length))</br>
                        &emsp;&emsp;return my_paths[index_of_minimum]</br>
                    </div>
                </div></br>
            </div></br>
        </div>
    </section>
{% endblock %}

{% block extra_js %}              
    <script src="{% static 'home/js/home.js' %}" type="text/javascript"></script>
{% endblock %}